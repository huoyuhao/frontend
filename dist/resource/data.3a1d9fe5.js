var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{d as n,q as r,B as s,f as m,x as p,_ as u,r as c,o as f,c as y,an as b,h as v,G as I,E as h,ap as x,j as w,ao as k,F as g}from"./vendor.3dbe8742.js";import{p as D}from"./index.d1bda31d.js";import{a as U,d as j}from"./index.0938e8a9.js";import{l as M}from"./config.0b912e9f.js";import"./index.ff13d247.js";import"./index.855c6cab.js";const _=n({name:"DAddMaterialData",components:{},props:{visible:{required:!0,type:Boolean,default:!1},formData:{type:Object,default:()=>null},isModify:{required:!0,type:Boolean,default:!1}},setup(e,{emit:a}){const t=r({}),l=r({}),o=e.isModify?"修改":"新增";M.forEach((e=>{const{title:a,dataIndex:o}=e;e.required&&(l[o]=[{required:!0,message:`${a}不能为空！`}]),t[o]=""}));const{useForm:d}=u,{resetFields:i,validate:n,validateInfos:c}=d(t,l),{visibleModal:f,close:y,submit:b}=U(s(e),a,{resetFields:i,validate:n},{formItem:t,api:"/material"}),v=m([]),I=m([]),h=()=>{D({api:"/material/type",method:"get"}).then((e=>{v.value=e.map((e=>({value:e.materialTypeId,label:e.materialTypeName})))})).catch(),D({api:"/material/unit",method:"get"}).then((e=>{I.value=e.map((e=>({value:e.materialUnitId,label:e.materialUnitName})))})).catch()};return p((()=>e.visible),(e=>{e&&h()})),h(),{title:o,dataType:v,dataUnit:I,list:M,formItem:t,visibleModal:f,validateInfos:c,close:y,submit:b}}});_.render=function(e,a,t,l,o,d){const i=c("a-select"),n=c("a-form-item"),r=c("a-input"),s=c("a-form"),m=c("a-modal");return f(),y(m,{visible:e.visibleModal,"onUpdate:visible":a[1]||(a[1]=a=>e.visibleModal=a),title:e.title,width:"800px",cancelText:"取消",okText:"提交",onOk:e.submit,onCancel:e.close},{default:b((()=>[v(s,{"label-col":{span:6},"wrapper-col":{span:14}},{default:b((()=>[(f(!0),y(I,null,h(e.list,(a=>(f(),y(I,null,["materialTypeId"===a.dataIndex?(f(),y(n,x({key:0,key:a.dataIndex,label:a.title},e.validateInfos[a.dataIndex]),{default:b((()=>[v(i,{value:e.formItem[a.dataIndex],"onUpdate:value":t=>e.formItem[a.dataIndex]=t,placeholder:"请选择","show-search":"","option-filter-prop":"label",options:e.dataType},null,8,["value","onUpdate:value","options"])])),_:2},1040,["label"])):"materialUnitId"===a.dataIndex?(f(),y(n,x({key:1,key:a.dataIndex,label:a.title},e.validateInfos[a.dataIndex]),{default:b((()=>[v(i,{value:e.formItem[a.dataIndex],"onUpdate:value":t=>e.formItem[a.dataIndex]=t,placeholder:"请选择","show-search":"","option-filter-prop":"label",options:e.dataUnit},null,8,["value","onUpdate:value","options"])])),_:2},1040,["label"])):a.hideForm?w("",!0):(f(),y(n,x({key:2,key:a.dataIndex,label:a.title},e.validateInfos[a.dataIndex]),{default:b((()=>[v(r,{value:e.formItem[a.dataIndex],"onUpdate:value":t=>e.formItem[a.dataIndex]=t},null,8,["value","onUpdate:value"])])),_:2},1040,["label"]))],64)))),256))])),_:1})])),_:1},8,["visible","title","onOk","onCancel"])};const O=n({name:"DProductMaterialData",components:{DAdd:_},setup(){const e=r({title:"物料",loading:!1,data:[],rowKey:"materialId",showModal:!1,formData:{}}),n="/material",m=[];M.forEach((a=>{const{dataIndex:t,rowKey:l,hideTable:o}=a;l&&(e.rowKey=t),o||m.push(a)})),m.push({title:"操作",dataIndex:"action",align:"center",width:"80px",slots:{customRender:"action"}});const p=()=>{e.loading=!0,D({api:n,method:"get"}).then((a=>{e.loading=!1,e.data=a})).catch()},u=()=>{p()},{deleteModal:c}=j();return p(),f=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&i(e,t,a[t]);if(l)for(var t of l(a))d.call(a,t)&&i(e,t,a[t]);return e})({},s(e)),a(f,t({columns:m,query:p,update:u,add:()=>{e.showModal=!0,e.formData={}},deleteData:a=>{const t=a[e.rowKey],l={method:"delete",api:n,data:{[e.rowKey]:t}};c(l,(()=>{u()}))},modify:a=>{e.showModal=!0,e.formData=a}}));var f}}),C=g("刷新"),K=g("新增"),T=g(" 操作 ");O.render=function(e,a,t,l,o,d){const i=c("a-button"),n=c("DownOutlined"),r=c("a-menu-item"),s=c("a-menu"),m=c("a-dropdown"),p=c("d-table"),u=c("d-card"),h=c("d-add");return f(),y(I,null,[v(u,{title:e.title},{default:b((()=>[v(p,{loading:e.loading,columns:e.columns,"data-source":e.data,rowKey:e.rowKey,isSearch:!0},{header:b((()=>[v(i,{type:"primary",onClick:e.query},{default:b((()=>[C])),_:1},8,["onClick"]),v(i,{type:"primary",onClick:e.add},{default:b((()=>[K])),_:1},8,["onClick"])])),action:b((({record:t})=>[v(m,{placement:"bottomCenter"},{overlay:b((()=>[v(s,null,{default:b((()=>[v(r,{key:"modify"},{default:b((()=>[v("a",{onClick:a=>e.modify(t)},"修改",8,["onClick"])])),_:2},1024),v(r,{key:"delete"},{default:b((()=>[v("a",{onClick:a=>e.deleteData(t)},"删除",8,["onClick"])])),_:2},1024)])),_:2},1024)])),default:b((()=>[v("a",{onClick:a[1]||(a[1]=k((()=>{}),["prevent"]))},[T,v(n)])])),_:2},1024)])),_:1},8,["loading","columns","data-source","rowKey"])])),_:1},8,["title"]),v(h,{visible:e.showModal,"onUpdate:visible":a[2]||(a[2]=a=>e.showModal=a),"form-data":e.formData,"is-modify":Boolean(e.formData[e.rowKey]),onUpdate:e.update},null,8,["visible","form-data","is-modify","onUpdate"])],64)};export{O as default};
