var a=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;import{d,aA as n,q as s,B as m,r as c,o as u,g as p,k as f,w as b,J as y,j as w,t as h,I as j}from"./vendor.7b399e54.js";import{p as O}from"./index.cdf0aeb6.js";import{d as v}from"./index.57446d29.js";import{D as g,m as D,l as K}from"./add-data.d9c27c37.js";import{_ as x}from"./index.0cf77487.js";const A=d({name:"DNoteData",components:{DAdd:g},setup(){const a=n("userNameObj"),d=s({title:"单据列表",loading:!1,data:[],rowKey:"",showModal:!1,formData:null,materialArr:[],materialObj:{},materialColumns:D}),c="/note",u=[];K.forEach((a=>{const{dataIndex:e,rowKey:t,hideTable:r}=a;t&&(d.rowKey=e),r||u.push(a)})),u.push({title:"操作",dataIndex:"action",align:"center",width:"80px",slots:{customRender:"action"}});const p=()=>{d.loading=!0,O({api:c,method:"get"}).then((a=>{d.loading=!1,d.data=a})).catch(),O({api:"/material",method:"get"}).then((a=>{d.materialArr=[],d.materialObj={},a.forEach((a=>{var e;d.materialArr.push({value:a.materialId,label:a.materialName}),d.materialObj[a.materialId]=(null==(e=null==a?void 0:a.materialUnit)?void 0:e.materialUnitName)||""}))})).catch()},f=()=>{p()},{deleteModal:b}=v();return p(),y=((a,e)=>{for(var t in e||(e={}))o.call(e,t)&&i(a,t,e[t]);if(r)for(var t of r(e))l.call(e,t)&&i(a,t,e[t]);return a})({},m(d)),e(y,t({userNameObj:a,columns:u,query:p,update:f,add:()=>{d.showModal=!0,d.formData={materialList:[],redBlue:0}},deleteData:a=>{const e=a[d.rowKey],t={method:"delete",api:c,data:{[d.rowKey]:e}};b(t,(()=>{f()}))},modify:a=>{d.showModal=!0,d.formData=a}}));var y}}),C=j("刷新"),k=j("新增"),I=j("删除");var M=x(A,[["render",function(a,e,t,r,o,l){const i=c("a-button"),d=c("d-table"),n=c("d-card"),s=c("d-add");return u(),p(y,null,[f(n,{title:a.title},{default:b((()=>[f(d,{loading:a.loading,columns:a.columns,"data-source":a.data,rowKey:a.rowKey,isSearch:!0},{header:b((()=>[f(i,{type:"primary",onClick:a.query},{default:b((()=>[C])),_:1},8,["onClick"]),f(i,{type:"primary",onClick:a.add},{default:b((()=>[k])),_:1},8,["onClick"])])),user:b((({text:e})=>[w("p",null,h(a.userNameObj[e]||e),1)])),action:b((({record:e})=>[f(i,{type:"primary",size:"small",onClick:t=>a.deleteData(e)},{default:b((()=>[I])),_:2},1032,["onClick"])])),expandedRowRender:b((({record:e})=>[f(d,{columns:a.materialColumns,"data-source":e.materialList,rowKey:"rawMaterialId"},null,8,["columns","data-source"])])),_:1},8,["loading","columns","data-source","rowKey"])])),_:1},8,["title"]),f(s,{visible:a.showModal,"onUpdate:visible":e[0]||(e[0]=e=>a.showModal=e),"form-data":a.formData,"is-modify":Boolean(a.formData&&a.formData[a.rowKey]),materialArr:a.materialArr,materialObj:a.materialObj,onUpdate:a.update},null,8,["visible","form-data","is-modify","materialArr","materialObj","onUpdate"])],64)}]]);export{M as default};
