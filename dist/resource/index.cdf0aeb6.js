var e=Object.defineProperty,s=(s,t,r)=>(((s,t,r)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r})(s,"symbol"!=typeof t?t+"":t,r),r);import{a as t,T as r}from"./vendor.7b399e54.js";import{r as a,a as o,b as n}from"./index.0cf77487.js";class i{constructor(){s(this,"instance"),this.instance=t.create({baseURL:"/api",timeout:3e4,withCredentials:!0,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json;"}}),this.setupInterceptors()}setupInterceptors(){this.instance.interceptors.request.use((e=>(a(e),o(e),e)),(()=>Promise.resolve({data:{msg:"服务器异常，请联系管理员！"}}))),this.instance.interceptors.response.use((e=>(a(e),e.data)),(e=>{let s,r=-1;if(t.isCancel(e))s="",r=-2;else{const{status:t}=e.response;(t<200||t>=300)&&(s=(e=>{let s="";switch(e){case 400:s="请求错误(400)";break;case 401:s="未授权，请重新登录(401)";break;case 403:s="拒绝访问(403)";break;case 404:s="请求出错(404)";break;case 408:s="请求超时(408)";break;case 500:s="服务器错误(500)";break;case 501:s="服务未实现(501)";break;case 502:s="网络错误(502)";break;case 503:s="服务不可用(503)";break;case 504:s="网络超时(504)";break;case 505:s="HTTP版本不受支持(505)";break;default:s=`连接出错(${e})!`}return`${s}，请检查网络或联系管理员！`})(t))}return Promise.resolve({msg:s,code:r})}))}getInterceptors(){return this.instance}}const c=new class{constructor(){s(this,"axios"),this.axios=(new i).getInterceptors()}request(e){return new Promise(((s,t)=>{this.axios(e).then((e=>{if(0===e.code)s(null==e?void 0:e.detail);else if(-2===e.code)console.log("请求多次。");else if(401===e.code){n();const e="未登录，请重新登陆";r.error(e),location.href="/#/login"}else{const s=(null==e?void 0:e.msg)||"系统繁忙，请稍后重试";r.error(s),t(s)}})).catch((e=>{e&&(null==e?void 0:e.msg)&&r.error(null==e?void 0:e.msg),t(e)}))}))}},l=({api:e,method:s,data:t})=>c.request({url:e,method:s,data:t});export{l as p};
