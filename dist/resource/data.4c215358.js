var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,r=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;import{d as s,q as n,az as i,B as u,f as p,x as m,a2 as c,r as f,o as b,c as y,w as v,k as h,g as I,E as w,J as x,as as g,h as j,j as k,t as D,I as O}from"./vendor.a502bbf1.js";import{p as M}from"./index.6829e04c.js";import{a as _,d as U}from"./index.81a36e1e.js";import{l as K}from"./config.a89bd074.js";import{_ as C}from"./index.b01bbdb3.js";const T=s({name:"DAddWarehouseData",components:{},props:{visible:{required:!0,type:Boolean,default:!1},formData:{type:Object,default:()=>null},isModify:{required:!0,type:Boolean,default:!1}},setup(e,{emit:a}){const t=n({}),o=n({}),l=i("userArr");K.forEach((e=>{const{title:a,dataIndex:l}=e;e.required&&(o[l]=[{required:!0,message:`${a}不能为空！`}]),t[l]=""}));const{useForm:d}=c,{resetFields:r,validate:s,validateInfos:f}=d(t,o),{visibleModal:b,close:y,submit:v}=_(u(e),a,{resetFields:r,validate:s},{formItem:t,api:"/warehouse"}),h=p([]);return m((()=>e.visible),(e=>{e&&M({api:"/warehouse/type",method:"get"}).then((e=>{h.value=e.map((e=>({value:e.warehouseTypeId,label:e.warehouseTypeName})))})).catch()})),{userArr:l,dataType:h,list:K,formItem:t,visibleModal:b,validateInfos:f,close:y,submit:v}}});const q=s({name:"DMaterialWarehouseData",components:{DAdd:C(T,[["render",function(e,a,t,o,l,d){const r=f("a-select"),s=f("a-form-item"),n=f("a-input"),i=f("a-form"),u=f("a-modal");return b(),y(u,{visible:e.visibleModal,"onUpdate:visible":a[0]||(a[0]=a=>e.visibleModal=a),title:e.isModify?"修改":"新增",width:"800px",cancelText:"取消",okText:"提交",onOk:e.submit,onCancel:e.close},{default:v((()=>[h(i,{"label-col":{span:6},"wrapper-col":{span:14}},{default:v((()=>[(b(!0),I(x,null,w(e.list,(a=>(b(),I(x,null,["warehouseTypeId"===a.dataIndex?(b(),y(s,g({key:0,key:a.dataIndex,label:a.title},e.validateInfos[a.dataIndex]),{default:v((()=>[h(r,{value:e.formItem[a.dataIndex],"onUpdate:value":t=>e.formItem[a.dataIndex]=t,placeholder:"请选择","show-search":"","option-filter-prop":"label",options:e.dataType},null,8,["value","onUpdate:value","options"])])),_:2},1040,["label"])):"warehouseManagerId"===a.dataIndex?(b(),y(s,g({key:1,key:a.dataIndex,label:a.title},e.validateInfos[a.dataIndex]),{default:v((()=>[h(r,{value:e.formItem[a.dataIndex],"onUpdate:value":t=>e.formItem[a.dataIndex]=t,placeholder:"请选择","show-search":"","option-filter-prop":"label",options:e.userArr},null,8,["value","onUpdate:value","options"])])),_:2},1040,["label"])):a.hideForm?j("",!0):(b(),y(s,g({key:2,key:a.dataIndex,label:a.title},e.validateInfos[a.dataIndex]),{default:v((()=>[h(n,{value:e.formItem[a.dataIndex],"onUpdate:value":t=>e.formItem[a.dataIndex]=t},null,8,["value","onUpdate:value"])])),_:2},1040,["label"]))],64)))),256))])),_:1})])),_:1},8,["visible","title","onOk","onCancel"])}]])},setup(){const e=i("userNameObj"),s=n({title:"仓库",loading:!1,data:[],rowKey:"",showModal:!1,formData:null}),p="/warehouse",m=[];K.forEach((e=>{const{dataIndex:a,rowKey:t,hideTable:o}=e;t&&(s.rowKey=a),o||m.push(e)})),m.push({title:"操作",dataIndex:"action",align:"center",width:"80px",slots:{customRender:"action"}});const c=()=>{s.loading=!0,M({api:p,method:"get"}).then((e=>{s.loading=!1,s.data=e})).catch()},f=()=>{c()},{deleteModal:b}=U();return c(),y=((e,a)=>{for(var t in a||(a={}))l.call(a,t)&&r(e,t,a[t]);if(o)for(var t of o(a))d.call(a,t)&&r(e,t,a[t]);return e})({},u(s)),a(y,t({userNameObj:e,columns:m,query:c,update:f,add:()=>{s.showModal=!0,s.formData={}},deleteData:e=>{const a=e[s.rowKey],t={method:"delete",api:p,data:{[s.rowKey]:a}};b(t,(()=>{f()}))},modify:e=>{s.showModal=!0,s.formData=e}}));var y}}),A=O("刷新"),P=O("新增"),B=O("删除");var E=C(q,[["render",function(e,a,t,o,l,d){const r=f("a-button"),s=f("d-table"),n=f("d-card"),i=f("d-add");return b(),I(x,null,[h(n,{title:e.title},{default:v((()=>[h(s,{loading:e.loading,columns:e.columns,"data-source":e.data,rowKey:e.rowKey,isSearch:!0},{header:v((()=>[h(r,{type:"primary",onClick:e.query},{default:v((()=>[A])),_:1},8,["onClick"]),h(r,{type:"primary",onClick:e.add},{default:v((()=>[P])),_:1},8,["onClick"])])),user:v((({text:a})=>[k("p",null,D(e.userNameObj[a]||a),1)])),action:v((({record:a})=>[h(r,{type:"primary",size:"small",onClick:t=>e.deleteData(a)},{default:v((()=>[B])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","data-source","rowKey"])])),_:1},8,["title"]),h(i,{visible:e.showModal,"onUpdate:visible":a[0]||(a[0]=a=>e.showModal=a),"form-data":e.formData,"is-modify":Boolean(e.formData&&e.formData[e.rowKey]),onUpdate:e.update},null,8,["visible","form-data","is-modify","onUpdate"])],64)}]]);export{E as default};
